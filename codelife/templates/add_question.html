<form method="POST">
    {% csrf_token %}
    <div id="question">
        <h2>{% if is_edit %}Edit Question{% else %}Add Question{% endif %}</h2>
        {{ form.as_p }}

        {% if form.errors %}
            <ul class="errorlist">
                {% for field in form %}
                    {% for error in field.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
            </ul>
        {% endif %}

        <button type="button" id="next" onclick="change(event)">Next</button>
    </div>

    <div id="testcase" style="display:none;">
        <h3>{% if is_edit %}Edit Testcases{% else %}Add Testcases{% endif %}</h3>
        {{ formset.management_form }}

        <div id="testcase-forms">
            {% for form in formset %}
                <div class="testcase-form">
                    {{ form.as_p }}
                    {{ form.DELETE }} 
                </div>
            {% endfor %}
        </div>

        <button type="button" id="add-testcase" onclick="addTestcase()">Add Another Testcase</button>
        <button type="submit">Submit</button>
    </div>
</form>

<script>
    function change(event) {
        event.preventDefault();
        document.getElementById('testcase').style.display = 'block';
        document.getElementById('question').style.display = 'none';
    }

    function addTestcase() {
        var formCount = document.getElementById('id_form-TOTAL_FORMS').value;
        var newForm = document.querySelector('.testcase-form').cloneNode(true);

        var inputs = newForm.querySelectorAll('input, textarea');
        inputs.forEach(function(input) {
            input.value = '';
        });

        document.getElementById('testcase-forms').appendChild(newForm);
        document.getElementById('id_form-TOTAL_FORMS').value = parseInt(formCount) + 1;
    }
</script>
